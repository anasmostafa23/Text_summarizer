<!DOCTYPE html>
<html>
  <head>
    <title>ML Service</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <h1>Welcome to the ML Service</h1>
    <p>Submit prompts, view tasks, and manage your account.</p><br>
    <a href="https://colab.research.google.com/drive/1kDspLli6dwIhXVFhr5Wk-T3tlUKFHWGG" target="_blank" rel="noopener noreferrer">bart-large-cnn text summarization model on Google Colab notebook</a><br><br>
    <p>Make sure the text to process is no more than 2500 characters</p>

    {% if error %}
    <p><strong>{{ error }}</strong></p>
    {% endif %}

    <!-- Text Summarization Form -->
    <form id="summarize-form" method="POST" action="/submit_task">
    
      <label for="text_to_summarize">Enter Text to Summarize:</label>
      <textarea
        id="text_to_summarize"
        name="text_to_summarize"
        rows="25"
        cols="170"
        required
      >{{ prompt }}</textarea>
      <button type="submit">Summarize</button>
    </form>

    <p id="char-count-message" style="color: red;"></p>

    <script>
      // Get elements for validation
      const textArea = document.getElementById('text_to_summarize');
      const charCountMessage = document.getElementById('char-count-message');
      const form = document.getElementById('summarize-form');

      // Function to check character length
      function checkTextLength() {
        const textLength = textArea.value.length;
        if (textLength > 2500) {
          charCountMessage.textContent = 'Text is too long! Please limit your text to 2500 characters.';
          form.querySelector('button').disabled = true; // Disable the submit button
        } else {
          charCountMessage.textContent = '';
          form.querySelector('button').disabled = false; // Enable the submit button
        }
      }

      // Add event listener to the textarea for input
      textArea.addEventListener('input', checkTextLength);

      // Initial check on page load
      checkTextLength();

      // Optional: Show an alert when the form is submitted
      form.addEventListener('submit', function (event) {
        alert('The summarized text will appear in your history in a few minutes!');
      });
    </script>

    <br><br><a href="/dashboard">Back to dashboard</a>
  </body>
</html>
